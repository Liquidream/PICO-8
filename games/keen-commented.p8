pico-8 cartridge // http://www.pico-8.com
version 18
__lua__

--
-- constants/variables
--
x=45  -- player start x & y position
y=404 -- (bottom-left corner of map)
v=0   -- player's jump/fall velocity
z=768 -- shorthand for large number (reused a few times)

--
-- (function shorthands)
--
r=rectfill
n=rnd
b=btn

--
-- step 1: generate our sprites
-- 
cls()         -- clear screen (remove any old text/gfx)

?"웃",0,3,1   -- draw keen,
?"●",0,0,10   -- ...and...
?"g",2,0,3    -- ...his helmet!

?"|",67,2,7   -- now draw...
?"●",65,0,8   -- ...a lollypop

?"★",89,3,11  -- finally, draw
?"p",92,0      -- ...a yorp!

r(8,0,15,7,1)  -- draw a couple of coloured sprite tiles
r(16,0,23,7,2) --
?"⧗",8,1,12    -- ..make this one look like industrial


memcpy(0,32*z,z) -- copy the whole screen memory to sprite mem
-- 1st param is destination (0 = start of sprite memory)
-- 2nd param is source, now...
--     0x6000 = start screen memory
--     0x6000 > decimal = 24576
--        32*z = 32*768 = 24576  (saved 1 char reusing z!)
-- 3rd param is length to copy. Reusing z here was excessive,
-- but probably saved 2 or more chars

--
-- step 2: generate the level map
-- 
cls(2)           -- start with dark blue (outside of level)
r(4,4,94,50,0)   -- draw a black box which will be play area
srand(6)         -- force the random number gen to one that 
                 -- creates a decent looking level

for i=9,50,2 do  -- pass vertically down through the level...
 ?"…",n(84),i,8  -- randomly drawing red pixels (8=sprite for lollipop)
 
 ?"id",7,x       -- have some lollipops spell "id" 
                 -- as tribute to creator of original
                 
 l=n(8)*7        -- pick a random platform length
 r(l,i,l+i/2,i,n(2)+1) -- draw a line (re-using rectfill to save chars) 
                       -- for platform, using random pos+length                       
 pset(l+9,i-1,11) -- place a "Yorp" on every ledge
end



for x=0,z do           -- loop through every screen pixel
 for y=0,z do          -- and populate map data with col value
  mset(x,y,pget(x,y))  -- (note: z used is way higher than req
 end                   --  but it saved chars + also had "happy accident" 
end                    --  side-effect of pausing to see mini-map data)

function _update60()
 cls(6)                -- set background to grey
 map(0,0,0,0,z,z)      -- draw entire map to screen, at pos 0,0
                       -- (again z is overkill here, but saved chars)

 camera(x-64,y-99)     -- move camera viewpoint to center on player pos 
 c=pget(x,y+4)         -- get pixel colour of player's current position
                       -- (get it before drawing player!)
 spr(0,x-4,y-5)        -- now draw player sprite (was generated earlier)

 y+=1                  -- apply default "gravity" (player is always falling)
 if(c!=6) y-=1 v=0     -- if player is currently "on" something, then:
                       --  > undo gravity force applied above
                       --  > reset the "jump" amount (as now on ground)
 
 if(c==8) mset(x/8,y/8+1,0) -- if player on red pixel (lollipop), then:
                            -- > collect by clearing map for current pos

 if(b(2) and v<19) v+=1 y-=2  -- if player pressed "up" and 
                              -- not already jumping too high, then:
                              -- > continue to allow "jumping"

 if(b(0)) x-=1          -- handle player moving left & right
 if(b(1)) x+=1          -- 

 x=mid(35,x,z)         -- force player to stay inside the map walls
end



__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__label__
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
88666666666666688866666666666668886666666666666666666666666666666666666666666666666666666666666666666666666666666666222222222222
86866666666666888686666666666688868666666666666666666666666666666666666666666666666666666666666666666666666666666666222222222222
88866666666666888886666666666688888666666666666666666666666666666666666666666666666666666666666666666666666666666666222222222222
88866666666666888886666666666688888666666666666666666666666666666666666666666666666666666666666666666666666666666666222222222222
88666666666666688866666666666668886666666666666666666666666666666666666666666666666666666666666666666666666666666666222222222222
76666666666666667666666666666666766666666666666666666666666666666666666666666666666666666666666666666666666666666666222222222222
76666666666666667666666666666666766666666666666666666666666666666666666666666666666666666666666666666666666666666666222222222222
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666222222222222
666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666bbb66666666666666666666666666666
666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666b6b66666666666666666666666666666
666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666bbb66666666666666666666666666666
666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666b6666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666bbb666666666666666666666666666666
666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666bbbbbbb6666666666666666666666666666
6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666bbbbb66666666666666666666666666666
6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666b666b66666666666666666666666666666
66666666666666666666222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
66666666666666666666222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
66666666666666666666222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
66666666666666666666222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
66666666666666666666222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
66666666666666666666222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
66666666666666666666222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
66666666666666666666222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
66666668886666688866666888666666666666688866666888666666666666666666666666666666666666666666666666661111111111111111111111111111
66666688868666888686668886866666666666888686668886866666666666666666666666666666666666666666666666661ccccc111ccccc111ccccc111ccc
666666888886668888866688888666666666668888866688888666666666666666666666666666666666666666666666666611ccc11111ccc11111ccc11111cc
6666668888866688888666888886666666666688888666888886666666666666666666666666666666666666666666666666111c1111111c1111111c1111111c
666666688866666888666668886666666666666888666668886666666666666666666666666666666666666666666666666611ccc11111ccc11111ccc11111cc
66666666766666667666666676666666666666667666666676666666666666666666666666666666666666666666666666661ccccc111ccccc111ccccc111ccc
66666666766666667666666676666666666666667666666676666666666666666666666666666666666666666666666666661111111111111111111111111111
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666661111111111111111111111111111
66666666666666688866666666666666666666688866666666666668886666666666666666666666666666666666666666666666666666666666666666666666
66666666666666888686666666666666666666888686666666666688868666666666666666666666666666666666666666666666666666666666666666666666
66666666666666888886666666666666666666888886666666666688888666666666666666666666666666666666666666666666666666666666666666666666
66666666666666888886666666666666666666888886666666666688888666666666666666666666666666666666666666666666666666666666666666666666
66666666666666688866666666666666666666688866666666666668886666666666666666666666666666666666666666666666666666666666666666666666
66666666666666667666666666666666666666667666666666666666766666666666666666666666666666666666666666666666666666666666666666666666
66666666666666667666666666666666666666667666666666666666766666666666666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
66666666666666688866666666666666666666688866666666666668886666666666666666666666666666666666666666666666666666688866666666666668
66666666666666888686666666666666666666888686666666666688868666666666666666666666666666666666666666666666666666888686666666666688
66666666666666888886666666666666666666888886666666666688888666666666666666666666666666666666666666666666666666888886666666666688
66666666666666888886666666666666666666888886666666666688888666666666666666666666666666666666666666666666666666888886666666666688
66666666666666688866666666666666666666688866666666666668886666666666666666666666666666666666666666666666666666688866666666666668
66666666666666667666666666666666666666667666666666666666766666666666666666666666666666666666666666666666666666667666666666666666
66666666666666667666666666666666666666667666666666666666766666666666666666666666666666666666666666666666666666667666666666666666
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
66666666666666688866666666666666666666688866666666666668886666666666666666666666666666666666666666666666666666666666666666666666
66666666666666888686666666666666666666888686666666666688868666666666666666666666666666666666666666666666666666666666666666666666
66666666666666888886666666666666666666888886666666666688888666666666666666666666666666666666666666666666666666666666666666666666
66666666666666888886666666666666666666888886666666666688888666666666666666666666666666666666666666666666666666666666666666666666
66666666666666688866666666666666666666688866666666666668886666666666666666666666666666666666666666666666666666666666666666666666
66666666666666667666666666666666666666667666666666666666766666666666666666666666666666666666666666666666666666666666666666666666
66666666666666667666666666666666666666667666666666666666766666666666666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
66666668886666688866666888666666666666688866666888666668886666666666666666666666666666666666666666666666666666666666666666666666
66666688868666888686668886866666666666888686668886866688868666666666666666666666666666666666666666666666666666666666666666666666
66666688888666888886668888866666666666888886668888866688888666666666666666666666666666666666666666666666666666666666666666666666
66666688888666888886668888866666666666888886668888866688888666666666666666666666666666666666666666666666666666666666666666666666
66666668886666688866666888666666666666688866666888666668886666666666666666666666666666666666666666666666666666666666666666666666
66666666766666667666666676666666666666667666666676666666766666666666666666666666666666666666666666666666666666666666666666666666
66666666766666667666666676666666666666667666666676666666766666666666666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666666a33666666666666666666666666666666666666666666666666666666666666666
6666666666666666666666666666666666666666666666666666666666666a3a6a66666666666666666666666666666666666666666666666666666666666666
6666666666666666666666666666666666666666666666666666666666666a3aaa66666666666666666666666666666666666666666666666666666666666666
6666666666666666666666666666666666666666666666666666666666666a3a3a66666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666666333666666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666661111166666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666666111666666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666666161666666666666666666666666666666666666666666666666666666666666666
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222

